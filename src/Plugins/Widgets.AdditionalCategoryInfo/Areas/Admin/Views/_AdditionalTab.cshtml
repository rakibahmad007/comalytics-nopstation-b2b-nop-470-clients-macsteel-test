@model AdditionalCategoryInfoModel

<div class="card-body">
    <input type="hidden" name="categoryId" id="categoryId" value="@Model.CategoryId" />
    <div class="form-group row">
        <div class="col-md-3">
            <nop-label asp-for="Active" />
        </div>
        <div class="col-md-9">
            <nop-editor asp-for="Active" />
            <span asp-validation-for="Active"></span>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-md-3">
            <nop-label asp-for="AdditionalInfoField" />
        </div>
        <div class="col-md-9">
            <nop-editor asp-for="AdditionalInfoField" asp-template="RichEditor" />
            <span asp-validation-for="AdditionalInfoField"></span>
        </div>
    </div>

    <div class="form-group row">
        <div class="col-md-9">
            <div id="additional-category-info-update-notification"></div>
            <input class="btn btn-primary" type="button" id="additional-info-submit" value="Save">
        </div>
    </div>
</div>
<script>
    $('#additional-info-submit').on('click', function () {
        var categoryId = $('#categoryId').val();
        var active = $('#Active').is(':checked');
        var additionalInfoField = window.parent.tinymce.get('AdditionalInfoField').getContent({ format: 'html' });

        var postData = {
            categoryId: categoryId,
            active: active,
            additionalInfoField: additionalInfoField
        };
        var additionalInfoData = {
            model: postData
        };
        addAntiForgeryToken(additionalInfoData);
        $.ajax({
            cache: false,
            method: "POST",
            url: "@(Url.Action("AdditionalCategoryInfoAction", "AdditionalCategoryInfo"))",
            data: additionalInfoData,
            success: function (data, textStatus, jqXHR) {
                    if (data.Result) {
                        $('#additional-category-info-update-notification').text(data.Msg).css('color', 'green');
                        $('#additional-category-info-update-notification').show();
                        $('#additional-category-info-update-notification').delay(3500).fadeOut('slow');
                    }
                    else {
                        $('#additional-category-info-update-notification').text(data.Msg).css('color','red');

                        $('#additional-category-info-update-notification').show();
                        $('#additional-category-info-update-notification').delay(3500).fadeOut('slow');
                    }
                },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#additional-category-info-update-notification').text('Failed to update').css('color', 'red');
                $('#additional-category-info-update-notification').show();
                $('#additional-category-info-update-notification').delay(3500).fadeOut('slow');
            },
            complete: function (jqXHR, textStatus) {
            }
        });
    });

</script>

