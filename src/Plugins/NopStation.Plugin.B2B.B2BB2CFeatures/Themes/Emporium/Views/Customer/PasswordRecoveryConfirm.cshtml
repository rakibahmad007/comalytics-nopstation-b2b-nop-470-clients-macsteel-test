@model PasswordRecoveryConfirmModel
@{
	Layout = "_ColumnsOne";
	NopHtml.AddTitleParts(T("PageTitle.PasswordRecovery").Text);
	NopHtml.AppendPageCssClassParts("html-password-recovery-page");
}
<div class="page password-recovery-page">
	<div class="page-title">
		<h1>@T("Account.PasswordRecovery")</h1>
	</div>
	<div class="page-body">
		@if (!string.IsNullOrEmpty(Model.Result))
		{
			<div class="result">
				@Model.Result
			</div>
			<div class="buttons">
				<a href="@Model.ReturnUrl" class="button-1">@T("Common.Continue")</a>
			</div>
		}
		@if (!Model.DisablePasswordChanging)
		{
			<form asp-route="PasswordRecoveryConfirm" asp-route-token="@Context.Request.Query["token"]" asp-route-guid="@Context.Request.Query["guid"]" method="post" autocomplete="off">
				<div asp-validation-summary="ModelOnly" class="message-error"></div>
				<div class="fieldset">
					<div class="form-fields">
						<div class="result password-rules"></div>
						<script asp-location="Footer">
							$(document).ready(function () {
								ErpAccountCommon.loadPasswordRequirmentsAjaxLoad();
							})
						</script>
						<div class="inputs">
							<label asp-for="NewPassword" asp-postfix=":"></label>
							<input asp-for="NewPassword" />
                            <span id="toggle-new-password"></span>
							<nop-required />
                            @{
                                var hasPasswordError = ViewData.ModelState.TryGetValue("NewPassword", out var passwordState)
                                && passwordState.Errors.Count > 0;
                            }
                            @if (hasPasswordError)
                            {
                                <!-- Custom HTML-rendered error for Password -->
                                <div class="field-validation-error">
                                    @foreach (var error in passwordState.Errors)
                                    {
                                        @Html.Raw(error.ErrorMessage)
                                    }
                                </div>
                            }
                            else
                            {
                                <span asp-validation-for="NewPassword"></span>
                            }
							@* <span asp-validation-for="NewPassword"></span> *@

                            <script>
                                document.getElementById("toggle-new-password").addEventListener("click", function (event) {
                                    event.target.classList.toggle("active");
                                    const passwordInput = document.getElementById("NewPassword");
                                    // Toggle the type attribute
                                    if (passwordInput.type === "password") {
                                        passwordInput.type = "text";  // Change to text to show the password
                                    } else {
                                        passwordInput.type = "password";  // Change back to password to hide it
                                    }
                                });
                            </script>
						</div>
						<div class="inputs">
							<label asp-for="ConfirmNewPassword" asp-postfix=":"></label>
							<input asp-for="ConfirmNewPassword" />
                            <span id="toggle-confirm-password"></span>
							<nop-required />
							<span asp-validation-for="ConfirmNewPassword"></span>
                            <script>
                                document.getElementById("toggle-confirm-password").addEventListener("click", function (event) {
                                    event.target.classList.toggle("active");
                                    const passwordInput = document.getElementById("ConfirmPassword");
                                    // Toggle the type attribute
                                    if (passwordInput.type === "password") {
                                        passwordInput.type = "text";  // Change to text to show the password
                                    } else {
                                        passwordInput.type = "password";  // Change back to password to hide it
                                    }
                                });
                            </script>
						</div>
					</div>
				</div>
				<div class="buttons">
					<button type="submit" name="set-password" class="button-1 new-password-button">@T("Account.PasswordRecovery.ChangePasswordButton")</button>
				</div>
			</form>
		}
	</div>
</div>
